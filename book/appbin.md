# Запуск программы
[](appbin)

##### Ключи:

`--copyright` - отображение сведений о копирайте;

`--version` - отображение версии интерпретатора;

`-(-h)elp` - отображение справочной информации;

`-0 [codepoint]` - изменение символа перевода строки, использующегося при чтении из потока (`$/`). Кодовая позиция задается в восьмеричной системе счисления.

+ Если кодовая позиция не указана, то строки разделятся не будут;
+ Если указана позиция -00, то в качестве разделителя будут использоваться два символа перевода строки подряд;
+ Если указана позиция -0777, то файлы буду обрабатываться как одна большая строка.

`-C (-X) <dir>` - изменение базового каталога;

`--encoding (-E) <external>[:internal]` - изменение внешней и внутренней кодировок;

`-F <pattern>` - изменение разделителя частей текста (`$;`), использующегося при вызове метода `.split`. В качестве образца передаются произвольные символы или тело регулярного выражения;

`-I <dirs>` - добавление дополнительных каталогов. Данные каталоги будут добавлены в начало `$LOAD_PATH ($:)` и использованы для поиска необходимых библиотек. Каталоги разделяются двоеточием (Linux) или точкой с запятой (Windows);

`-K <encoding>` - изменение внешней и внутренней кодировок.

+ _e_ - EUC-JP;  
  _s_ - Windows-31J (CP932);  
  _u_ - UTF-8;  
  _n_ - ASCII-8BIT (BINARY).

`-S` - поиск программы с помощью переменной окружения PATH;

`-T [security]` - изменение уровня безопасности для программы (по умолчанию 1);

`-U` - использование UTF-8 в качестве внутренней кодировки;

`-W [verbose]` - изменение степени подробности отладочной информации:

+ _0_ - без предупреждений, `$VERBOSE` ссылается на nil;  
  _1_ - средний уровень, `$VERBOSE` ссылается на false;  
  _2_ (по умолчанию) - выводятся все предупреждения, `$VERBOSE` ссылается на true.

`-a` - автоматическое разделение кода на строки при использовании ключей `-n` или `-p`. В начале каждой итерации цикла выполняется код: `$F = $_.split!`;

`-c` - проверка синтаксиса. Если ошибок не найдено, то в стандартный поток для вывода передается `"Syntax OK"`;

`-(-d)ebug` - запуск в режиме отладки (`$DEBUG` ссылается на true).

Наличие ключа позволяет писать код для отладки программы, который будет выполняться только если `$DEBUG` ссылается на true;  
`{verbatim} if $DEBUG`

`-e <verbatim>` - выполнение произвольного кода;

`-i [ext]` - запуск в режиме редактирования, позволяющий записывать данные с помощью ARGF. Расширение используется для создания резервных копий файлов;

`-l` - автоматическое изменение кода. При этом, во-первых, `$\` копирует `$/`, и, во-вторых, для каждой строки вызывается метод `.chop!`;

`-n` - выполнение программы в теле цикла (каждая строка программы выполняется отдельно):

~~~~~ ruby
  while gets
    # code
  end
~~~~~

`-p` - выполнение программы в теле цикла (каждая строка кода выполняется отдельно, результат передается в стандартный поток для вывода):

~~~~~ ruby
  while gets
    # code
  end
  print
~~~~~

`-r <lib>` - загрузка дополнительной библиотеки перед выполнением с помощью `.require`;

`-s` - предварительная обработка аргументов, начинающихся с дефиса. Обработка выполняется до любого обычного аргумента или символов `--`. Обработанные аргументы будут удалены из ARGV.

+ Для аргументов вида `-x=y`, `$x` в теле программы будет ссылаться на y;
+ Для аргументов вида `-x`, `$x` в теле программы будет ссылаться на true.

`-(-v)erbose` - запуск программы с ключом -w. Если имя программы не указано, то отображается версия интерпретатора.

Наличие ключа позволяет писать код для отладки программы, который будет выполняться только если `$VERBOSE` ссылается на true;  
`{verbatim} if $VERBOSE`

`-w` - отображение всех возможных предупреждений (`$VERBOSE` ссылается на true);

`-x [dir]` - отображение кода программы со строки, начинающейся с `!#` и содержащей `ruby`. Конец программы должен быть указан с помощью EOF (обозначение конца файла), `^D` (control-D), `^Z` (control-Z), или `__END__`. Переданный каталог используется вместо базового;

`-(-y)ydebug` - используется для отладки интерпретатора;

`--disable-... (--enable-...)` - включение или отключение указанной опции:

+ _gems_ - поиск библиотек в пакетах (отключение этой опции может ускорить запуск программы);  
  _rubyopt_ - использование переменной окружения RUBYOPT;  
  _all_ - выполнение двух перечисленных действий.

`--dump <target>` - используется для отладки интерпретатора.

*****

##### Переменные окружения:

`RUBYLIB` - список каталогов, используемых для поиска библиотек;

`RUBYOPT` - список ключей, используемых для запуска программ. Могут быть добавлены только ключи -d, -E, -I, -K, -r, -T, -U, -v, -w, -W, `--debug, --disable-...` и `--enable-...`;

`RUBYPATH` - список каталогов, в которых выполняется поиск программы;

`RUBYSHELL` - путь к оболочке ОС. Переменная действительна только для mswin32, mingw32, и OS/2;

`PATH` - путь к интерпретатору.

*****

Доступ к перемнным окружения может быть получен с помощью ENV - объекта, подобный ассоциативному массиву. Для объекта определен метод `.to_hash`, преобразующий его в настоящий ассоциативный массив.

##### Глобальные переменные:

`$F` - результат последнего выполнения выражения `$_.split`. Переменная определена, если программа запущена с ключами -a, -n или -p;

`$-W` - степень подробности предупреждений;

`$-i` - расширение, используемое для резервных копий;

`$-d # -> bool`;

`$-l # -> bool`;

`$-v # -> bool`;

`$-p # -> bool`;

`$-a # -> bool`;

`$*` - массив аргументов, переданных при запуске программы;

`$>` - поток для записи по умолчанию;

`$; ($-F)` - используется при вызове метода `string.split`. Разделитель частей текста (по умолчанию nil);

`$/ ($-0)` - используется `kernel.gets`. Символ перевода строки (по умолчанию - `"\n"`). Если ссылается на nil, то вызов метода вернет весь текст;

`$\\` - разделитель, добавляемый при передаче объектов в поток (по умолчанию nil);

`$,` - используется при вызове методов `array.join` и `kernel.printf` Разделитель элементов (по умолчанию nil);

`$~` - экземпляр класса MatchData для последнего поиска совпадений;

`$&` - текст последнего найденного совпадения;

``$` `` - текст, предшествующий последнему найденным совпадением;

`$'` - текст, следующий за последним найденным совпадением;

`$+` - текст последнего совпадения с группой;

`$1, $2, $3, $4, $5, $6, $7, $8, $9` - текст последнего совпадения с группой, имеющей соответствующий индекс;

`$LOAD_FEAUTURES ($")` - массив всех использованных библиотек (изменение значения элементов запрещено в Ruby 2.0; для объектов не относящихся к String вызывается метод `object.to_path`);

`$LOAD_PATH ($:, $-I)` - массив каталогов, использующихся для поиска библиотек (изменение значения элементов запрещено в Ruby 2.0; для объектов не относящихся к String вызывается метод `object.to_path`);

`$.` - позиция последней извлеченной строки из потока;

`$_` - последняя извлеченная строка из потока;

`$!` - последнее полученное исключение;

`$@` - местоположение в коде последнего полученного исключения;

`$DEBUG` - true, если программа запущена с ключом `-(-d)ebug`;

`$VERBOSE ($-v, $-w)`

+ _nil_, если программа запущена с ключом `-W0`;  
  _true_, если программа запущена с ключами `-w` или `-(-v)erbose`;  
  _false_ в остальных случаях.

`$$` - идентификатор текущего процесса;

`$?` - статус последнего выполненного процесса;

`$FILENAME` - относительный путь к текущему файлу в ARGF. При взаимодействии с стандартным потоком для ввода возвращается `"-"`;

`$SAFE` - текущий уровень безопасности.

*****